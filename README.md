Please note this is my first project in python i learned python in a few days to make this little project
due to i couldn't find a bot on discord to accomplish this task. 

im open to changes to the code or updating it with bug fixes/ optimization <3

Features

    Fetches recent malware samples from MalwareBazaar.
    Fetches recent malicious URLs from URLhaus.
    Filters out duplicate samples.
    Posts the detected samples to specific Discord channels.
    Logs the activity to a designated logging channel.
    Periodically checks for new samples every 15 minutes.
    Uploads the collected data to a GitHub repository.
    Obfuscates URLs in messages to prevent accidental clicks.

Prerequisites

    Python 3.8+
    Discord bot token
    MalwareBazaar API key
    URLhaus API key
    GitHub personal access token with repo scope
    python-dotenv library for environment variable management

Functions
Initialization

    MalwareBot.__init__(): Initializes the bot instance with necessary attributes like seen hashes, seen URLs, and a semaphore for message sending.

GitHub Integration

    MalwareBot.upload_to_github(filename, file_content): Uploads or updates a file in the GitHub repository.
    MalwareBot.upload_files_to_github(): Uploads the malware and URL samples JSON files to GitHub.

JSON Handling

    MalwareBot.load_samples_from_json(filename): Loads samples from a specified JSON file.
    MalwareBot.save_samples_to_json(samples, filename): Saves samples to a specified JSON file.

URL Obfuscation

    MalwareBot.obfuscate_url(url): Obfuscates URLs to prevent accidental clicks.

Logging

    MalwareBot.log_to_channel(channel, message): Sends a log message to the specified Discord channel.

Duplicate Detection

    MalwareBot.is_duplicate_sample(sample, filename): Checks if a sample is a duplicate based on existing JSON data.

Data Fetching

    MalwareBot.fetch_recent_malware_samples(): Fetches recent malware samples from MalwareBazaar.
    MalwareBot.fetch_recent_urlhaus_samples(): Fetches recent malicious URLs from URLhaus.

Message Sending

    MalwareBot.send_messages_in_batches(channel, messages, batch_size=5): Sends messages in batches to avoid hitting rate limits.
    MalwareBot.send_samples_embed(samples, channel, source): Sends an embed message for each sample to the specified channel.

Embed Creation

    MalwareBot.create_malware_embed(sample): Creates an embed message for a malware sample.
    MalwareBot.create_url_embed(sample): Creates an embed message for a URL sample.

Summary Logging

    MalwareBot.send_summary_log(malware_samples, urlhaus_samples, start_time): Sends a summary log of the fetched samples.

Periodic Task

    MalwareBot.periodic_check(): Periodically checks for new samples and processes them.

Discord Events

    on_ready(): Event handler for when the bot is ready.
    on_message(message): Event handler for processing incoming messages.

JSON Output

malware_samples.json

Stores malware samples in the following format:

[
    {"sha256_hash": "hash1"},
    {"sha256_hash": "hash2"}
]

urlhaus_samples.json

Stores URL samples in the following format:

[
    {"url": "http://example.com/malicious1"},
    {"url": "http://example.com/malicious2"}
]

License

This project is licensed under the MIT License. https://opensource.org/license/mit
